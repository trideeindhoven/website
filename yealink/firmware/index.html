<!DOCTYPE html>
<html lang="nl">

<head>

<meta charset="utf-8">
<title>CloudAware Technical Consultancy | Firmware</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<link rel="apple-touch-icon" sizes="180x180" href='/website/apple-touch-icon.png'>
<link rel="icon" type="image/png" sizes="32x32" href='/website/favicon-32x32.png'>
<link rel="icon" type="image/png" sizes="16x16" href='/website/favicon-16x16.png'>
<link rel="manifest" href='/website/site.webmanifest'>

<link href='/website/css/fa6.min.css' rel="stylesheet" type="text/css">




<link rel="stylesheet" href="/website/css/style.min.77906017340b15ad69f27f2cd27f0833d0e78a75185c356924d7a17bf623e6fd.css" />


<link href='/website/css/style.min.css' rel="stylesheet" type="text/css">
<link rel="stylesheet" href='/website/css/custom.css'>
<script defer type="text/javascript" src="/website/js/privacy-manager/config.js"></script>
<script defer type="text/javascript" src="/website/js/privacy-manager/klaro.js"></script>

<script>
  var _paq = window._paq = window._paq || [];
   
  _paq.push(['requireCookieConsent']);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://app.cloudaware.eu/cloudtr/";
    _paq.push(['setTrackerUrl', u+'cloudtr']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src=u+'cloudtr.js'; s.parentNode.insertBefore(g,s);
  })();
</script>



<meta property="og:title" content="CloudAware Technical Consultancy | Firmware" />




<meta name="description" content="Firmware">
<meta property="og:title" content=" | " />
<meta property="og:site_name" content="CloudAware Technical Consultancy">
<meta property="og:description" content="Firmware">
<meta property="og:url" content="https://trideeindhoven.github.io/website/yealink/firmware/">
<meta property="og:type" content="website">
<meta property="og:locale" content="">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@tech_chiba">

<link rel="canonical" href="https://trideeindhoven.github.io/website/yealink/firmware/">

<meta name="twitter:description" content="Firmware">
<meta property="article:published_time" content="2024-03-05T00:00:00&#43;00:00">
<meta property="article:updated_time" content="2024-03-05T00:00:00&#43;00:00">





    
<meta property="og:image" content="https://trideeindhoven.github.io/website/img/yealink/pexels-markus-spiske-2004161.jpg">
    


<meta name="twitter:title" content="Firmware">
<link rel="preload" href='/css/sweetalert2.min.css' as="style"
    onload="this.onload=null;this.rel='stylesheet'">

</head>

<body class="flex flex-col min-h-screen">
  <main class="flex-grow"><header>
    <div id="overlay">
        <ul class="text-center list-none text-white text-3xl">
            
            <li class="p-2">
                <a href="/website/blog/">
                    <span>Blog</span>
                </a>
            </li>
            
            <li class="p-2">
                <a href="/website/support">
                    <span>Support</span>
                </a>
            </li>
            
            <li class="p-2">
                <a href="/website/about/">
                    <span>Over</span>
                </a>
            </li>
            
            <li class="p-2">
                <a href="/website/spreker/">
                    <span>Spreker</span>
                </a>
            </li>
            
            <li class="p-2">
                <a href="/website/contact/">
                    <span>Contact</span>
                </a>
            </li>
            
        </ul>
    </div>
    <nav class="flex items-center justify-between flex-wrap bg-opacity-100 p-8">
        <div class="flex items-center flex-shrink-0 text-xl text-grey-900 mr-6">
            <a href="https://trideeindhoven.github.io/website/"><img alt="CloudAware Logo"
                    class="h-14 mr-3" src="/website/img/logo/cloudaware.png"></a>
        </div>
        <div class="block lg:hidden">
            <div id="hamburgerbtn" class="flex cursor-pointer items-center w-14 h-10 py-2 rounded mopen">
                <span class="top"></span>
                <span class="middle"></span>
                <span class="bottom"></span>
            </div>
        </div>
        <div class="hidden w-full block flex-grow lg:flex lg:items-center lg:w-auto" id="mobileMenu">
            <div class="text-lg lg:flex-grow">
            </div>
            <div class="text-lg">
                
                <a href="/website/blog/"
                    class="duration-200 block mt-4 lg:inline-block lg:mt-0 text-black hover:opacity-60 mr-8">
                    Blog
                </a>
                
                <a href="/website/support"
                    class="duration-200 block mt-4 lg:inline-block lg:mt-0 text-black hover:opacity-60 mr-8">
                    Support
                </a>
                
                <a href="/website/about/"
                    class="duration-200 block mt-4 lg:inline-block lg:mt-0 text-black hover:opacity-60 mr-8">
                    Over
                </a>
                
                <a href="/website/spreker/"
                    class="duration-200 block mt-4 lg:inline-block lg:mt-0 text-black hover:opacity-60 mr-8">
                    Spreker
                </a>
                
                <a href="/website/contact/"
                    class="duration-200 block mt-4 lg:inline-block lg:mt-0 text-black hover:opacity-60 mr-8">
                    Contact
                </a>
                
            </div>
        </div>
    </nav>
</header><div class="scroll-top rounded-full">
      <span class="icon-keyboard_arrow_up text-2xl"></span>
    </div>
<div class="mx-auto my-10 max-w-6xl">
    <div class="mx-3 col-span-3 lg:col-span-2 px-2">
        <h1 class="title text-5xl font-bold mb-3">Firmware</h1>
        <section class="mb-4 text-lg">
            <h4 id="date" class="flex flex-row items-center"><span class="icon-access_time text-2xl mr-2"></span>
                2024/03/05 </h4>
            
            <h4 class="flex flex-row items-center"><span class="icon-person text-2xl mr-2"></span>Jeroen Hermans
            </h4>
            
            
        </section>
        Translations of this article:<br />

        <a href="https://cloudaware-eu.translate.goog/website/yealink/firmware/?_x_tr_sl=nl&_x_tr_tl=en&_x_tr_hl=nl&_x_tr_pto=wapp"><img alt="EN" src="/website/img/uxwing/united-kingdom-flag-icon.svg" style="margin-top:5px;margin-bottom:5px;width:50px;display: inline;"></a>
        <a href="https://cloudaware-eu.translate.goog/website/yealink/firmware/?_x_tr_sl=nl&_x_tr_tl=de&_x_tr_hl=nl&_x_tr_pto=wapp"><img alt="EN" src="/website/img/uxwing/germany-flag-icon.svg" style="margin-top:5px;margin-bottom:5px;width:50px;display: inline;"></a>
        <a href="https://cloudaware-eu.translate.goog/website/yealink/firmware/?_x_tr_sl=nl&_x_tr_tl=fr&_x_tr_hl=nl&_x_tr_pto=wapp"><img alt="EN" src="/website/img/uxwing/france-flag-icon.svg" style="margin-top:5px;margin-bottom:5px;width:50px;display: inline;"></a>

        
        <img class="my-4" src="https://trideeindhoven.github.io/website/img/yealink/pexels-markus-spiske-2004161.jpg">
        
        <div class="content prose md:prose-lg lg:prose-xl max-w-none py-1"><p>In april 2023 brengt zowel Lydis als Yealink een redelijk cryptische memo naar buiten. Het is niet eenvoudig in te zien
wat de strekking van deze memo is, maar wat op dat moment nog niemand weet is dat de oorzaak van deze memo ikzelf ben
en een direct gevolg van mijn samenwerking met Yealink en Lydis.</p>
<h1 id="unpack">Unpack</h1>
<p>Laten we voorop stellen dat ik een redelijk matige reverse engineer ben, maar het was ook voor mij kinderlijk eenvoudig
om de &ldquo;versleutelde&rdquo; firmware van Yealink en Lydis uit te lezen. De reden hierachter was dat iemand al het lastige werk
voor mij gedaan had.</p>
<p>In augustus 2019 had Tristan Pourcelot namelijk een fantastisch artikel geschreven over

<a target="_blank" href="https://www.synacktiv.com/en/publications/no-grave-but-the-sip-reversing-a-voip-phone-firmware">reversing firmware</a> <i class="fa fa-external-link"></i>


<a target="_blank" href="https://web.archive.org/web/20231101233259/https://www.synacktiv.com/en/publications/no-grave-but-the-sip-reversing-a-voip-phone-firmware">mirror</a> <i class="fa fa-external-link"></i>

van de firmware van Yealink.<br>
En niet alleen had hij een artikel hierover geschreven, hij had ook een GitHub repository gemaakt met de software die
hij hiervoor gemaakt had. Jaren later in 2022 krijg ik dit artikel onder ogen en kan ik de firmware van Yealink en
Lydis eenvoudig uitlezen.</p>
<p>De manier waarop de firmware &ldquo;beveiligd&rdquo; is leunt sterk op het principe van &ldquo;security through obscurity&rdquo;. Yealink heeft
een eigen beveiliging verzonnen die niet bij het grote publiek bekend is. Maar voor Tristan is het meteen duidelijk
hoe deze firmware uitgelezen moet worden.<br>
In het kort werkt de &ldquo;beveiliging&rdquo; als volgt:</p>
<ul>
<li>In de .rom file zitten meerdere filesystems aan elkaar geplakt.</li>
<li>De eerste 512 bytes van de filesystem headers zijn versleuteld.</li>
<li>Het filesystem zelf is niet versleuteld en is in cleartext blocks aanwezigin het .rom bestand. Ik weet niet waarom
hier voor gekozen is, maar ik neem aan dat de

<a target="_blank" href="https://nl.wikipedia.org/wiki/System-on-a-chip">SoC</a> <i class="fa fa-external-link"></i>

in de apparatuur niet krachtig genoeg is om het volledige filesystem
tijdens het booten te decrypten.</li>
<li>De firmware is niet ondertekend (signed), waardoor het vaststellen van de integriteit&hellip;lastig is.</li>
<li>De gebruikte versleuteling is AES-ECB. Waar hebben we dat ook weer eerder <a href="https://trideeindhoven.github.io/website/yealink/versleuteling/">gezien</a></li>
</ul>
<p>Yealink brengt hier zelfs een memo over uit waar ik later op terugkom. In deze memo staat:

<blockquote class="cloudquote">
Lydis customized firmware is affected
</blockquote>
</p>
<p>&hellip;Lydis customized firmware&hellip; laten we daar even op inzoomen!</p>
<h1 id="188-firmware">&ldquo;188&rdquo; firmware</h1>
<p>Het schrijven van een samenhangend verhaal over de findings in dit onderzoek is een aardige opgave. Er is zo veel
informatie, tijdlijnen moeten worden nagezocht en laten we niet vergeten hoe belangrijk het is om informatie te
controlen op waarheid. We hebben dat in een eerder artikel ook al gezien.<br>
En dat is ook voor dit artikel niet anders. En ik denk op dit punt in het verhaal is het goed om het over de &ldquo;188&rdquo; firmware te hebben.</p>
<p>Yealink maakt regelmatig nieuwe

<a target="_blank" href="https://support.yealink.com/en/portal/docDetail?documentCode=105f1c68a5a54ee4">firmware</a> <i class="fa fa-external-link"></i>


<a target="_blank" href="https://web.archive.org/web/20240303161233/https://support-cdn.yealink.com/attachment/temp/20221108/24527720-098f-47a8-9513-edc14dd4dd1f.pdf?v=1667909984814">mirror</a> <i class="fa fa-external-link"></i>

voor hun apparatuur. Wat hier b.v. opvalt is de firmwareversie in het formaat x.y.0.z.<br>
Hierbij is:</p>
<ul>
<li>x: het apparaat type</li>
<li>y: de &ldquo;major&rdquo; versie</li>
<li>&ldquo;0&rdquo;: dit is een Yealink internationale versie</li>
<li>z: het patch niveau</li>
</ul>
<p>Als we naar de

<a target="_blank" href="https://portal.lydis.com/download/yealink/Latest_Yealink_Firmware.zip">Nederlandse firmware</a> <i class="fa fa-external-link"></i>


<a target="_blank" href="https://web.archive.org/web/20240302151931/https://portal.lydis.com/download/yealink/Latest_Yealink_Firmware.zip">mirror</a> <i class="fa fa-external-link"></i>

kijken dan zien we dat dit derde getal altijd, voor alle apparatuur, &ldquo;188&rdquo; is. De &ldquo;188&rdquo; firmware wordt alleen door Lydis
verkocht. Dus als een grote distributeur als Atis of Businesscom een Yealink apparaat verkoopt in Nederland, dan komt dit apparaat van
Lydis af met de &ldquo;188&rdquo; firmware.</p>
<p>Als we nu voor device &ldquo;146&rdquo; (DECT W70B) gaan kijken, dan zien we dat 
<a target="_blank" href="https://support.yealink.com/en/portal/docDetail?documentCode=105f1c68a5a54ee4">Yealink</a> <i class="fa fa-external-link"></i>


<a target="_blank" href="https://web.archive.org/web/20240303161233/https://support-cdn.yealink.com/attachment/temp/20221108/24527720-098f-47a8-9513-edc14dd4dd1f.pdf?v=1667909984814">mirror</a> <i class="fa fa-external-link"></i>

op major versie 85 zit en op patchniveau 40.<br>
Als we nu in de Nederlandse firmware kijken, dan zien we voor dit device firmware: 146.85.188.8. Het patchniveau is dus &ldquo;8&rdquo; en
dus ouder dan de firmware voor alle andere landen buiten het werkgebied van Lydis.</p>
<p>En nu hoor ik de oplettende lezer denken: nou en? En dat is een terechte èn belangrijke vraag. Want het is duidelijk
dat de firmware versie die Lydis verkoopt in de BeNeLux ouder is dan de versie die alle andere landen ter wereld krijgen.
Het is eenvoudig om te bepalen of dit een probleem is of niet en dus zoek ik voor dit apparaat een

<a target="_blank" href="https://nvd.nist.gov/vuln/detail/CVE-2019-14656">CVE</a> <i class="fa fa-external-link"></i>
 er bij met een klinkende

<a target="_blank" href="https://en.wikipedia.org/wiki/Common_Vulnerability_Scoring_System">CVSS</a> <i class="fa fa-external-link"></i>

van 8.8 (&ldquo;do not
properly check user roles in POST requests&rdquo;). De CVE is van augustus 2019 en er wordt gesproken over een

<a target="_blank" href="https://sway.cloud.microsoft/3pCb559LYVuT0eig">0-day exploit</a> <i class="fa fa-external-link"></i>


<a target="_blank" href="https://web.archive.org/web/20240303162154/https://sway.cloud.microsoft/3pCb559LYVuT0eig">mirror</a> <i class="fa fa-external-link"></i>

in juli 2019. Dat is op het moment van schrijven (maart 2024) dus al bijna 5 jaar geleden.<br>
Yealink geeft in hun

<a target="_blank" href="https://www.yealink.com/en/trust-center/security-advisories/cve-2019-14656-yealink-phone-privilege-escalation-vulnerabilities">eigen advisory</a> <i class="fa fa-external-link"></i>


<a target="_blank" href="https://web.archive.org/web/20240303160528/https://www.yealink.com/en/trust-center/security-advisories/cve-2019-14656-yealink-phone-privilege-escalation-vulnerabilities">mirror</a> <i class="fa fa-external-link"></i>

aan dat dit gerepareerd is in 146.85.0.35<br>
Yealink laat de releasedates van hun firmware versies niet online staan, dus dit is niet meer te controleren wanneer dit
is geweest. Aangezien patchlevel 25 in februari 2022 is uitgekomen, moet het daarna zijn.<br>
Dit betekent dat we hieruit dus het volgende kunnen concluderen:</p>
<ul>
<li>Klanten buiten de BeNeLux krijgen een patch voor een 0-day waar Yealink zelf en advisory voor heeft gemaakt pas na
jaren aangeboden</li>
<li>Klanten in de BeNeLux krijgen hun firmware exclusief in de &ldquo;188&rdquo; versie van Lydis</li>
<li>In bovenstaand voorbeeld is uit het patchniveau af te leiden dat de klanten van Lydis nog steeds geen patch hebben
voor de CVSS van 8.8</li>
</ul>
<p>Uiteraard heb ik ook aan Lydis gevraagd of het klopt dat hun firmware achter loopt op de internationale versie. Tijdens
een interview met de technisch directeur van Lydis geeft hij aan dat dit komt:

<blockquote class="cloudquote">
Zo houden we rust in de markt he. Omdat we veel carrier klanten hebben, die willen niet elke maand een nieuwe update willen ontvangen en die testen doorlopen. Nu kunnen we zelf min of meer bepalen wanneer we een grote update uitbrengen gebaseerd op de internationale versie en normaliter lopen we daar een aantal weken op achter omdat ze die nieuwe versie moeten maken. Maar we kunnen zelf beslissen naar carrier klanten moet je wel updaten of moet je niet updaten
</blockquote>
 (evidence-code: 2301171230)</p>
<p>Hier geeft Lydis dus duidelijk aan dat de &ldquo;188&rdquo; firmware een ander release schema heeft dan de &ldquo;0&rdquo; internationale
firmware. Tijdens het interview geeft de technisch directeur van Lydis aan dat als er &ldquo;dringende&rdquo; zaken zijn, dat er
dan sneller een release kan plaatsvinden. Maar bovenstaande uiteenzetting van versienummers en datum laat zien dat
het er alle schijn van heeft dat die policy niet effectief is in het voorkomen van security problemen.<br>
De prioriteit ligt duidelijk op compatibiliteit en certificering van platformen zoals Teams en 3CX, en veel minder op
security.</p>
<p>Even terug naar de firmware die ik heb kunnen inzien. Yealink gaf hierover zelf aan dat het voor de internationale
firmware niet zo&rsquo;n groot probleem was, maar dat de &ldquo;Lydis customized firmware is affected&rdquo;. Hoe komt dit nou eigenlijk?</p>
<p>Een van de belangrijke sellingpoints van de &ldquo;188&rdquo; firmware is de Nederlandse vertaling die Lydis voor Yealink heeft
gemaakt. Op moment dat ik in Duitsland een telefoon koop van Yealink, dan kan ik hier geen Nederlandse taal selecteren.<br>
Doordat ik nu de firmware van Lydis heb kunnen inzien heb ik ook inzage in het Nederlands taalbestand van Lydis. Ik kan
mij voorstellen dat Lydis dit als een handelsgeheim beschouwd.</p>
<p>Maar een ander geheim in de &ldquo;188&rdquo; firmware zijn de provider codes. Als ik in de lijst van providercodes kijk, dan zie
ik klinkende namen staan:</p>
<ul>
<li>Lydis</li>
<li>KPN</li>
<li>Lanlogic</li>
<li>SIP-NL</li>
<li>VoipIT</li>
<li>KPN EEN</li>
<li>HIP Express Office</li>
<li>Telfort Zakelijk</li>
<li>Dean Connect (hulde heren voor de provisioning url!)</li>
<li>Massxess IPCCC</li>
<li>Esprittelecom Direct</li>
<li>CBizz</li>
<li>Tele2</li>
<li>Telfort</li>
<li>Proximus</li>
<li>BellQ</li>
<li>Mijnconfig</li>
<li>StormKPN</li>
<li>VofafoneOne (sic)</li>
</ul>
<p>Dat klinkt in elk geval als een lijst van belangrijke partijen in Nederland en Belgie. Maar welke informatie staat er nu
daadwerkelijk zichtbaar in de firmware? Bestudering van het bestand autop_code.cfg levert de volgende data op:</p>
<ul>
<li>provisioning urls</li>
<li>gebruikersnamen en wachtwoorden</li>
<li>(base64 geëncode) AES sleutels voor de common en MAC specifieke configuratie</li>
</ul>
<p>Goede beveiliging zal nooit op een enkele beveiligingslaag vertrouwen. Maar op deze manier worden er wel een aantal
belangrijke lagen van beveiliging weggepeld. Nu ben ik iemand die dit netjes aan Lydis en Yealink heeft gemeld (vandaar
de memo die naar grote klanten is uitgestuurd), maar het is natuurlijk niet bekend wie verder nog deze informatie in
handen heeft gekregen. Dit leidt dan ook tot zeer ernstige beveiligingsvraagstukken voor enorm grote groepen gebruikers
bij de grote carriers in Nederland en België.</p>
<p>Maar hoe ziet de configuratie er dan uit? Ik heb een voorbeeld genomen van een van de providercodes (Lydis, 188):</p>
<pre tabindex="0"><code>  [ autoprovision1 ]
Name = Lydis
code = #*188#
server_address = https://lydisprovisioning.nl
user = supersecret
password = TmljZSB0cnksIG1hYXIgbmVlLg==
AES = T29rIGhpZXIgbmlldHMgdGUgemllbg==
MAC_AES = RG9vcmxvcGVuIGF1Yg==
</code></pre><p>Het moge duidelijk zijn dat deze gegevens in handen van de verkeerde mensen de beveiliging en privacy van zeer grote
groepen klanten van partijen als KPN, Vodafone en Proximus in gevaar brengen.<br>
Maar wat ook opvalt is dat er verschillende providercodes zijn zonder een AES sleutel. Dat betekent dat het document
niet versleuteld wordt met de methode zoals deze in het artikel over de <a href="https://trideeindhoven.github.io/website/yealink/versleuteling/">versleuteling</a> is
beschreven. Deze extra laag van beveiliging lijkt hier dan ook volledig te ontbreken.<br>
Ook zijn er enkele providers welke zelfs geen gebruikersnaam en wachtwoord hebben gebruikt voor hun provisioning. Ik
kan alleen maar gissen naar de beweegredenen om deze extra laag beveiliging niet te gebruiken.</p>
<p>Als ik de firmware verder bestudeer zie ik ook het Nederlandse taalbestand staan wat de Lydis &ldquo;188&rdquo; firmware zo belangrijk
maakt in de BeNeLux. Helaas is het niveau van de vertaling bijzonder laag. Een aantal voorbeelden uit het (grote)
taalbestand:</p>
<ul>
<li>Het Engelse &ldquo;level&rdquo; wordt als &ldquo;nivo&rdquo; vertaald. Nu vroeg ik mij meteen af if dit wellicht een toegestane
schrijfwijze is. Maar een korte zoektocht bij Van Dale en

<a target="_blank" href="https://taaladvies.net/buro-of-bureau-nivo-of-niveau-kado-of-cadeau/">andere sites</a> <i class="fa fa-external-link"></i>

laat duidelijk zien dat dit geen correct Nederlands is.</li>
<li>Maar dan zie ik ook dat er verschillende Engelse termen niet vertaald zijn. Denk hierbij aan &ldquo;Call Push&rdquo; wat vertaald
wordt als &ldquo;Push&rdquo;. En dit keer hoef ik niet op te zoeken of dit een correct Nederlands woord is.</li>
<li>Maar het kan nog erger. De Nederlandse vertaling van &ldquo;Invalid Common AES Key!&rdquo; lijkt wel geautomatiseerd door een
computer gedaan. De vertaling is namelijk: &ldquo;Ongeldige Standaard AES toets!&rdquo;. Hier is duidelijk dat de vertaling niet is
gemaakt door iemand die het Nederlands machtig is en waarschijnlijk een google-translate vertaling is.</li>
</ul>
<p>De matige kwaliteit van de vertaling is extra zuur aangezien hier per telefoon extra voor betaald moet worden. Ik heb
zelf een tijd lang telefoons uit Oostenrijk geïmporteerd. Deze telefoons hadden een (meer up-to-date) internationale
firmware en ik laadde hier zelf een Nederlands taalpakket in. Deze constructie kostte (zelfs met verzendkosten in kleine
hoeveelheden) minder dan &ldquo;Nederlandse&rdquo; telefoons bij Lydis inkopen.</p>
<p>Tijd om vragen te gaan stellen dus. In december 2022 stel ik de eerste vragen over de &ldquo;188&rdquo; firmware aan Yealink:</p>

<blockquote class="cloud">
Who produces the "188" Dutch Lydis firmware? Is this Lydis or Yealink? Can you elaborate on the release procedure of this special firmware?
</blockquote>

<p>Pas eind januari krijg ik antwoord van Yealink

<blockquote class="cloudemail">
Yealink produces the 188 Dutch firmware which based on the latest international firmware with customer’s customization items, like Dutch language and etc.
</blockquote>

Dit wordt later ook door Lydis bevestigd dat zij deze firmware niet zelf bouwen, maar dat zij hiervoor alleen samenwerken
met Yealink in China.</p>
<p>Als ik Lydis vraag of zij zelf eigenlijk wel eens onderzoeken hebben gedaan naar de beveiliging krijg ik van de
directeur van Lydis het antwoord dat het allemaal op vertrouwen is gebeurd. Een ongelofelijke uitspraak die wellicht
prima verklaart wat ik tot nu toe allemaal gevonden heb.</p>
<h1 id="reactie-yealink">Reactie Yealink</h1>
<p>En dus komt Yealink met een

<a target="_blank" href="https://portal.lydis.com/download/yealink/gz_new_fw/YEALINK_IP_PHONE_SECURITY_ISSUE_APR2023.PDF">reactie</a> <i class="fa fa-external-link"></i>


<a target="_blank" href="https://web.archive.org/web/20240302220402/https://portal.lydis.com/download/yealink/gz_new_fw/YEALINK_IP_PHONE_SECURITY_ISSUE_APR2023.PDF">mirror</a> <i class="fa fa-external-link"></i>
</p>
<p>Uit deze reactie hebben we al eerder een quote gezien in de inleiding. Het is een interessante zinssnede:

<blockquote class="cloudemail">
The Yealink genetic (sic...?) firmware don’t have customized URL information preset, but Lydis customized firmware is affected because it has auto provisioning code.
</blockquote>

Wat deze &ldquo;auto provisioning code&rdquo; is en welke gevoelige data van grote hoeveelheden carrier klanten hiervan gebruik maken
weten we inmiddels. Het advies van Yealink is dan ook:

<blockquote class="cloudquote">
Change the AutoProvision URL/username/password
</blockquote>
</p>
<p>En hoewel dat als een goed advies klinkt zou het ook verwoord kunnen worden als: &ldquo;We hebben de credentials gelekt van alle
grote carriers met meer dan 70% marktaandeel in de BeNeLux&rdquo;. Maar ik begrijp dat zo een mailing voorzichtig verwoord moet
worden. Maar ik betwijfel of de carriers de noodzaak van deze memo hebben begrepen.</p>
<h1 id="reactie-lydis">Reactie Lydis</h1>
<p>Maar ook Lydis ziet de noodzaak om zelf met een mailing te komen naar aanleiding van mijn melding. Zij sturen een

<a target="_blank" href="https://trideeindhoven.github.io/website/yealink/Mailing_Lydis_Klanten_260423.pdf">mailing</a> <i class="fa fa-external-link"></i>
 naar hun grote klanten in april 2023.</p>
<p>De memo begint met

<blockquote class="cloudquote">
Beste “contactpersoon”
</blockquote>

Die aanhef geeft alvast &ldquo;vertrouwen&rdquo; in dit document. Het document gaat verder met te vermelden:</p>

<blockquote class="cloudemail">
ondanks dat we vanuit de Benelux nog geen berichten ontvangen hebben, maar omdat het in theorie een security issue is.
</blockquote>

<p>Er zijn wel berichten vanuit de BeNeLux en wel van mij. En het is niet in theorie een security issue, maar ik heb de provider codes uit de firmware gehaald. En hier zeg ik niet alleen zelf van dat dit gevoelige informatie is, maar ook Yealink en Lydis
zijn dat met mij eens. Het is niet mogelijk om te weten voor zowel Yealink als Lydis of ik de enige persoon ben die deze
codes heeft ingezien of dat er nog 100 mensen de software van GitHub hebben gedownload en deze providercodes hebben
ingezien. Bovenstaand is dus een grove manier van downplayen die wederom de belangrijke carrierklanten niet het gevoel
geeft dat er iets belangrijks heeft plaatsgevonden.</p>
<p>Maar dit past wel in het plaatje wat ik van Lydis heb. In hun

<a target="_blank" href="https://www.lydis.nl/over-ons/yealink-security-faq">security FAQ</a> <i class="fa fa-external-link"></i>


<a target="_blank" href="https://web.archive.org/web/20240226235252/https://www.lydis.nl/over-ons/yealink-security-faq">mirror</a> <i class="fa fa-external-link"></i>

schrijven zij namelijk onder het kopje &ldquo;Waar kan ik zien welke kwetsbaarheden er gevonden zijn in de beveiliging van Yealink producten?&rdquo; het volgende:

<blockquote class="cloudemail">
Yealink scoort positief op cvedetails.com
</blockquote>
</p>
<p>cvedetails.com Is geen Libris Literatuurprijs. Het is een verzameling van CVE&rsquo;s en disclosures. Maar als we dan voor het
gedachtenexperiment meegaan in deze denkwijze, laten we dan even kijken wat er inderdaad op cvedetails.com over Yealink
gezegd wordt. Een van de eerste zoekresultaten is

<a target="_blank" href="https://www.cvedetails.com/cve/CVE-2021-27561/">CVE-2021-27561</a> <i class="fa fa-external-link"></i>
.
En inderdaad is dit een mooie CVSS score: 10 op een schaal van 10. &ldquo;unauthenticated remote code execution.&rdquo;. Het is wel
kenmerkend voor CVE&rsquo;s voor Yealink dat er iets mis is met hun authenticatie of authorisatie. Maar ook Remote Code
Execution (RCE) is iets wat is te vaak tegenkom voor een firma van deze statuur.<br>
cvedetails.com vervolgt het rapport met: &ldquo;Probability of exploitation activity in the next 30 days: 97.42%&rdquo;</p>
<p>We kunnen dus inderdaad concluderen dat Yealink behoorlijk scoort op cvedetails.com. Het hangt er dan wel van af natuurlijk
wat de

<a target="_blank" href="https://veiliginternetten.nl/thema/kinderen-online/op-school/wat-het-verschil-tussen-een-white-hat-en-een-black/">kleur van je hoedje</a> <i class="fa fa-external-link"></i>

is.</p>
<p>En dus besluit de telecomgigant uit Xiamen om de obfuscation van hun firmware aan te passen. En ze doen dit met terugwerkende
kracht ook voor EOL devices. Soms is dat wel 
<a target="_blank" href="https://support.yealink.com/en/portal/docList?archiveType=software&amp;productCode=85585442c3aeb1fb">6 jaar</a> <i class="fa fa-external-link"></i>

na de laatste firmware update.</p>
<img src="https://trideeindhoven.github.io/website/img/yealink/20240202_yealink_sipt27p_firmware.png" alt="SIP-T27P firmware releases"  >

<p>Wat hier opvalt is dat de firmware update bijna een half jaar na de memo&rsquo;s van Yealink en Lydis verschijnt.<br>
Ook valt op dat de firmware ineens 8% groter is geworden. Ik zou niet weten waarom dit zou zijn. Het ZOU natuurlijk iets
met het nieuwe algoritme te maken kunnen hebben wat gebruikt wordt om de firmware onleesbaar te maken. Volgens de

<a target="_blank" href="https://support.yealink.com/en/portal/docDetail?documentCode=4a1a04e0b6be4a1b">changelog</a> <i class="fa fa-external-link"></i>


<a target="_blank" href="https://trideeindhoven.github.io/website/yealink/Yealink%20SIP%20Phone%20Release%20Notes.pdf">mirror</a> <i class="fa fa-external-link"></i>

van de SIP-T27P zijn er in elk geval geen wijzigingen in de firmware zelf doorgevoerd.</p>
<p>Maar zo zal Yealink zich toch niet helemaal goed hebben gevoeld bij deze surprise firmware update en hoe enorm zichtbaar
dit voor iedereen is. En daarom besluit de telecomgigant om alle 
<a target="_blank" href="https://support.yealink.com/en/portal/docList?archiveType=software&amp;productCode=b0d249cb02451c0d">release datums</a> <i class="fa fa-external-link"></i>
 van firmware aan te passen naar maart 2015:
<img src="https://trideeindhoven.github.io/website/img/yealink/20240302_sipt28p_firmwareversions.png" alt="SIP-T28P firmware releases"  >
</p>
<p>Het blijft opvallen dat de transparantie van zowel Lydis en Yealink vaak ver te zoeken is. Hierbij moet ik wel opmerken
dat Lydis mij na een meeting enkele weken geleden beloofd heeft dat zij meer transparantie willen gaan uitdragen.<br>
Dit gebrek aan transparantie is opvallend te noemen aangezien zowel Yealink als Lydis dit voortdurend als verwijt naar
mij toe gebruiken. En&hellip;.Lydis laat het niet bij verwijten. De advocaat van Lydis schrijft in beide sommaties:</p>

<blockquote class="cloudquote">
Tevens verzoeken danwel sommeren we u om per ommegaande doch uiterlijk aanstaande maandag 18 september 2023 om 12:00 uur helderheid te verschaffen aan ondergetekende over uw beweegredenen en opdrachtgever(s) althans daar in ieder geval transparant over te zijn<br/><span>Mr. <font style="background-color: #ff0000; color: #ff0000;" title="Naam gecensureerd i.v.m. juridische redenen">************</font> van AKD N.V.</span>
</blockquote>

<p>Het blijft mij dan ook verbazen dat het juist op alle vlakken aan deze transparantie ontbreekt bij vrijwel alle
bedrijven die bij Yealink betrokken zijn. Het is voor mij niet vast te stellen wat de beweegredenen hier achter zijn<br>
Tot zo ver dit artikel over Yealink en Lydis. Het volgende artikel komt uit op vrijdag 8 maart. Tot dan!</p></div>
        <div class="share m-2 grid grid-cols-2 lg:grid-cols-3 gap-2">
            <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2ftrideeindhoven.github.io%2fwebsite%2fyealink%2ffirmware%2f&text=Firmware" target="_blank"
                title="Tweet" class="share-button twitter">
                <div class="text-white text-center">
                    <span class="icon-twitter text-lg mr-2"></span>Twitter
                </div>
            </a>
            <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftrideeindhoven.github.io%2fwebsite%2fyealink%2ffirmware%2f&t=Firmware" target="_blank"
                title="Facebook" class="share-button facebook">
                <div class="text-white text-center">
                    <span class="icon-facebook text-lg mr-2"></span>Facebook
                </div>
            </a>
            <a href="https://b.hatena.ne.jp/add?mode=confirm&url=https%3a%2f%2ftrideeindhoven.github.io%2fwebsite%2fyealink%2ffirmware%2f&title=Firmware" target="_blank"
                title="hatena" class="share-button hatena">
                <div class="text-white text-center">
                    <span class="icon-hatenabookmark text-lg mr-2"></span>Hatena
                </div>
            </a>
            <a href="https://getpocket.com/edit?url=https%3a%2f%2ftrideeindhoven.github.io%2fwebsite%2fyealink%2ffirmware%2f&title=Firmware" target="_blank" title="pocket"
                class="share-button pocket">
                <div class="text-white text-center">
                    <span class="icon-get-pocket text-lg mr-2"></span>Pocket
                </div>
            </a>
            <a href="https://timeline.line.me/social-plugin/share?url=https%3a%2f%2ftrideeindhoven.github.io%2fwebsite%2fyealink%2ffirmware%2f" class="share-button line">
                <div class="text-white text-center">
                    <span class="icon-line text-lg mr-2"></span>LINE
                </div>
            </a>
            <a href="javascript:OnClickURL();" class="share-button url" title="Copy to Clipboard"
                data-clipboard-text="Firmware https://trideeindhoven.github.io/website/yealink/firmware/" id="url">
                <div class="text-white text-center">
                    <span class="icon-link text-lg mr-2"></span>Copy
                </div>
            </a>
        </div>
        <hr class="py-4">
        <aside id="meta">
            <div class="grid grid-cols-2">
                <div class="col-span-1">
                    
                    <a class="previous lg:text-2xl" href="https://trideeindhoven.github.io/website/yealink/yealink_europe/">
                        <div
                            class="transition-colors duration-300 border border-gray-600 hover:border-black h-auto m-3 text-center py-3 lg:py-1">
                            <span class="icon-keyboard_arrow_left"></span> Yealink (Europe) Network Technology B.V.
                        </div>
                    </a>
                    
                </div>
                
                <a class="next lg:text-2xl" href="https://trideeindhoven.github.io/website/yealink/publicatie/">
                    <div
                        class="transition-colors duration-300 col-span-1 border border-gray-600 hover:border-black h-auto m-3 text-center py-3 lg:py-1">
                        Publicatie <span class="icon-keyboard_arrow_right"></span>
                    </div>
                </a>
                
            </div>
        </aside>
    </div>
</div>

  </main><footer class="bg-tlgray-100">
  
  <script src='/website/js/clipboard.min.js'></script>
  <script src='/website/js/highlight.min.js'></script>
  <script src='/website/js/highlightjs-line-numbers.min.js'></script>
  <script src='/website/js/sweetalert2.min.js'></script>
  <script>
    hljs.initHighlightingOnLoad();
    hljs.initLineNumbersOnLoad();
    new ClipboardJS('.url');

    function OnClickURL() {
      Swal.fire({
        icon: 'success',
        title: 'Copied!',
        text: 'Copied the URL and title.'
      })
    }
  </script>
  
  <script>
    function toggleNav() {
      var hamburger = document.getElementById("hamburgerbtn");
      var overlay = document.getElementById("overlay");
      var body = document.body;

      hamburger.addEventListener("click", function () {
        overlay.classList.toggle("open");
        hamburger.classList.toggle("is-open");
        body.classList.toggle("scroll-lock");
      });
    }
    toggleNav();

    document.querySelector('.scroll-top').addEventListener('click', () => {
      document.documentElement.scrollTop = 0;
    });
  </script>
  
  <link href='/website/css/webfonts.min.css' rel="stylesheet" />
  
  <div class="flex items-center justify-between flex-wrap bg-gray-800 p-8 text-white">
    <div class="items-center text-xl text-grey-900 mr-6">
      CloudAware Technical Consultancy
    </div>
    <div class="w-full block flex-grow lg:flex lg:items-center lg:w-auto" id="mobileMenu">
      <div class="text-lg lg:flex-grow">
      </div>
      <div class="flex flex-row items-center text-lg">
        
        <a href="/website/privacybeleid" class="block mt-4 lg:inline-block lg:mt-0 text-gray-300 hover:text-white mr-8">
          
          Privacy statement
          
        </a>
        
        <a href="/website/cookieverklaring" class="block mt-4 lg:inline-block lg:mt-0 text-gray-300 hover:text-white mr-8">
          
          Cookieverklaring
          
        </a>
        
        <a href="/website/" class="block mt-4 lg:inline-block lg:mt-0 text-gray-300 hover:text-white mr-8">
          
          Home
          
        </a>
        
        <a href="https://github.com/gitaware" class="block mt-4 lg:inline-block lg:mt-0 text-gray-300 hover:text-white mr-8">
          
          <i class='icon-github text-2xl'></i>
          
        </a>
        
      </div>
    </div>
  </div>
  <div class="copy pl-8 py-5 bg-tlgray-700 text-white text-md">
    &copy; CloudAware Technical Consultancy 2024 All Rights Reserved.
  </div>
</footer>
</body>

</html>