<!DOCTYPE html>
<html lang="nl">

<head>


<meta charset="utf-8">
<title>CloudAware Technical Consultancy | Paxton en het rebelse rootcertificaat</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<link rel="apple-touch-icon" sizes="180x180" href='/website/apple-touch-icon.png'>
<link rel="icon" type="image/png" sizes="32x32" href='/website/favicon-32x32.png'>
<link rel="icon" type="image/png" sizes="16x16" href='/website/favicon-16x16.png'>
<link rel="manifest" href='/website/site.webmanifest'>

<link href='/website/css/fa6.min.css' rel="stylesheet" type="text/css">




<link rel="stylesheet" href="/website/css/style.min.77906017340b15ad69f27f2cd27f0833d0e78a75185c356924d7a17bf623e6fd.css" />


<link href='/website/css/style.min.css' rel="stylesheet" type="text/css">
<link rel="stylesheet" href='/website/css/custom.css'>
<script defer type="text/javascript" src="/website/js/privacy-manager/config.js"></script>
<script defer type="text/javascript" src="/website/js/privacy-manager/klaro.js"></script>

<script>
  var _paq = window._paq = window._paq || [];
   
  _paq.push(['requireCookieConsent']);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://app.cloudaware.eu/cloudtr/";
    _paq.push(['setTrackerUrl', u+'cloudtr']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src=u+'cloudtr.js'; s.parentNode.insertBefore(g,s);
  })();
</script>



<meta property="og:title" content="CloudAware Technical Consultancy | Paxton en het rebelse rootcertificaat" />




<meta name="description" content="CloudAware">
<meta property="og:title" content=" | " />
<meta property="og:site_name" content="CloudAware Technical Consultancy">
<meta property="og:description" content="CloudAware">
<meta property="og:url" content="https://trideeindhoven.github.io/website/blog/paxton_tls/">
<meta property="og:type" content="article">
<meta property="og:locale" content="">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@tech_chiba">

<link rel="canonical" href="https://trideeindhoven.github.io/website/blog/paxton_tls/">

<meta name="twitter:description" content="CloudAware">
<meta property="article:published_time" content="2024-08-30T00:00:00&#43;00:00">
<meta property="article:updated_time" content="2024-08-30T00:00:00&#43;00:00">





    
<meta property="og:image" content="https://trideeindhoven.github.io/website/img/blog/pexels-negativespace-97077.jpg">
    


<meta name="twitter:title" content="Paxton en het rebelse rootcertificaat">
<link rel="preload" href='/css/sweetalert2.min.css' as="style"
    onload="this.onload=null;this.rel='stylesheet'">

</head>

<body class="flex flex-col min-h-screen">
  <main class="flex-grow"><header>
    <div id="overlay">
        <ul class="text-center list-none text-white text-3xl">
            
            <li class="p-2">
                <a href="/website/blog/">
                    <span>Blog</span>
                </a>
            </li>
            
            <li class="p-2">
                <a href="/website/support">
                    <span>Support</span>
                </a>
            </li>
            
            <li class="p-2">
                <a href="/website/about/">
                    <span>Over</span>
                </a>
            </li>
            
            <li class="p-2">
                <a href="/website/spreker/">
                    <span>Spreker</span>
                </a>
            </li>
            
            <li class="p-2">
                <a href="/website/contact/">
                    <span>Contact</span>
                </a>
            </li>
            
        </ul>
    </div>
    <nav class="flex items-center justify-between flex-wrap bg-opacity-100 p-8">
        <div class="flex items-center flex-shrink-0 text-xl text-grey-900 mr-6">
            <a href="https://trideeindhoven.github.io/website/"><img alt="CloudAware Logo"
                    class="h-14 mr-3" src="/website/img/logo/cloudaware.png"></a>
        </div>
        <div class="block lg:hidden">
            <div id="hamburgerbtn" class="flex cursor-pointer items-center w-14 h-10 py-2 rounded mopen">
                <span class="top"></span>
                <span class="middle"></span>
                <span class="bottom"></span>
            </div>
        </div>
        <div class="hidden w-full block flex-grow lg:flex lg:items-center lg:w-auto" id="mobileMenu">
            <div class="text-lg lg:flex-grow">
            </div>
            <div class="text-lg">
                
                <a href="/website/blog/"
                    class="duration-200 block mt-4 lg:inline-block lg:mt-0 text-black hover:opacity-60 mr-8">
                    Blog
                </a>
                
                <a href="/website/support"
                    class="duration-200 block mt-4 lg:inline-block lg:mt-0 text-black hover:opacity-60 mr-8">
                    Support
                </a>
                
                <a href="/website/about/"
                    class="duration-200 block mt-4 lg:inline-block lg:mt-0 text-black hover:opacity-60 mr-8">
                    Over
                </a>
                
                <a href="/website/spreker/"
                    class="duration-200 block mt-4 lg:inline-block lg:mt-0 text-black hover:opacity-60 mr-8">
                    Spreker
                </a>
                
                <a href="/website/contact/"
                    class="duration-200 block mt-4 lg:inline-block lg:mt-0 text-black hover:opacity-60 mr-8">
                    Contact
                </a>
                
            </div>
        </div>
    </nav>
</header><div class="scroll-top rounded-full">
      <span class="icon-keyboard_arrow_up text-2xl"></span>
    </div>
<div class="mx-auto my-10 max-w-6xl">
    <div class="mx-3 col-span-3 lg:col-span-2 px-2">
        <h1 class="title text-5xl font-bold mb-3">Paxton en het rebelse rootcertificaat</h1>
        <section class="mb-4 text-lg">
            <h4 id="date" class="flex flex-row items-center"><span class="icon-access_time text-2xl mr-2"></span>
                2024/08/30 </h4>
            
            <h4 class="flex flex-row items-center"><span class="icon-person text-2xl mr-2"></span>Jeroen Hermans
            </h4>
            
            
        </section>
        Translations of this article:<br />

        <a href="https://cloudaware-eu.translate.goog/website/blog/paxton_tls/?_x_tr_sl=nl&_x_tr_tl=en&_x_tr_hl=nl&_x_tr_pto=wapp"><img alt="EN" src="/website/img/uxwing/united-kingdom-flag-icon.svg" style="margin-top:5px;margin-bottom:5px;width:50px;display: inline;"></a>
        <a href="https://cloudaware-eu.translate.goog/website/blog/paxton_tls/?_x_tr_sl=nl&_x_tr_tl=de&_x_tr_hl=nl&_x_tr_pto=wapp"><img alt="EN" src="/website/img/uxwing/germany-flag-icon.svg" style="margin-top:5px;margin-bottom:5px;width:50px;display: inline;"></a>
        <a href="https://cloudaware-eu.translate.goog/website/blog/paxton_tls/?_x_tr_sl=nl&_x_tr_tl=fr&_x_tr_hl=nl&_x_tr_pto=wapp"><img alt="EN" src="/website/img/uxwing/france-flag-icon.svg" style="margin-top:5px;margin-bottom:5px;width:50px;display: inline;"></a>

        
        <img class="my-4" src="https://trideeindhoven.github.io/website/img/blog/pexels-negativespace-97077.jpg">
        
        <div class="content prose md:prose-lg lg:prose-xl max-w-none py-1"><p>Certificaten&hellip; Een mooie technologie om identiteit vast te stellen en om betrouwbare encryptie tussen twee
partijen op te zetten. Maar het blijkt in de praktijk keer op keer een moeilijk onderwerp te zijn.</p>
<p>&ldquo;Jeroen, ik denk dat je eens met mij mee moet kijken.&rdquo;. Het is een conculega van mij die mij op een regenachtige middag
in april 2023 belt. Het zijn juist deze telefoontjes waar je vooraf niet van weet waar het op uit gaat lopen. En juist
dit telefoontje blijkt uiteindelijk te leiden tot een CVE met een cvss van 9.8!</p>
<p>De man die mij belt is actief bij de lokale tennisvereniging en is in die hoedanigheid ook betrokken bij de installatie
van een nieuw toegangssysteem, compleet met pasjes. Tijdens het installeren van dit systeem is het de bedoeling dat
er beheerssoftware voor het systeem ge√Ønstalleerd wordt op de computer van diegene die verantwoordelijk is voor
de beveiliging. Het lijkt een logische stap te zijn, maar&hellip;ook een gevoelige plek om software te installeren.<br>
We hebben in de afgelopen jaren verschillende gevallen gezien waar supplychain attacks gevoelige plekken blootstelden
aan onnodige gevaren. In dit geval gaat het om een gebouwtoegangssysteem van

<a target="_blank" href="https://www.paxton-access.com">Paxton</a> <i class="fa fa-external-link"></i>
.</p>
<p>Paxton is een firma die zichzelf omschrijft als een &ldquo;toonaangevende fabrikant van elektronische toegangscontrole, video
management en deurintercom systemen&rdquo;, waarbij zij &ldquo;een optimale beveiliging van uw gebouwen, medewerkers en bezittingen&rdquo;
leveren. Dat klinkt als een mooie ambitie. En die ambitie maken zij waar bij klanten die ik toch wel onder gevoelige
objecten reken. Denk hierbij aan</p>
<ul>
<li>
<a target="_blank" href="https://www.paxton-access.com/nl/casestudy-gelredome">Gelredome</a> <i class="fa fa-external-link"></i>
</li>
<li>
<a target="_blank" href="https://www.paxton-access.com/nl/manchester-united-old-trafford/">Old Trafford stadium Manchester</a> <i class="fa fa-external-link"></i>
</li>
<li>
<a target="_blank" href="https://www.paxton-access.com/nl/casestudy-TriNed">Internet Provider Trined</a> <i class="fa fa-external-link"></i>
</li>
<li>
<a target="_blank" href="https://www.paxton-access.com/nl/knvb-campus/">KNVB Campus</a> <i class="fa fa-external-link"></i>
</li>
<li>
<a target="_blank" href="https://www.paxton-access.com/nl/study-brandweer/">Brandweer Midden- en West-Brabant</a> <i class="fa fa-external-link"></i>
</li>
<li>
<a target="_blank" href="https://www.paxton-access.com/nl/SBS-Broadcasting/">SBS Broadcasting</a> <i class="fa fa-external-link"></i>
</li>
<li>
<a target="_blank" href="https://www.paxton-access.com/nl/studios-aalsmeer/">Studio&rsquo;s Aalsmeer</a> <i class="fa fa-external-link"></i>
</li>
<li>
<a target="_blank" href="https://www.paxton-access.com/nl/endemol-productions-londen/">Endemol Producties Londen</a> <i class="fa fa-external-link"></i>
</li>
<li>
<a target="_blank" href="https://www.paxton-access.com/case-studies/sky-deutschland/">Sky Deutschland</a> <i class="fa fa-external-link"></i>
</li>
<li>
<a target="_blank" href="https://www.paxton-access.com/nl/loodswezen/">Loodswezen</a> <i class="fa fa-external-link"></i>
</li>
<li>
<a target="_blank" href="https://www.paxton-access.com/case-studies/cherbourg-airport/">Cherbourg Airport</a> <i class="fa fa-external-link"></i>
</li>
<li>
<a target="_blank" href="https://www.paxton-access.com/nl/dhl-te-maastricht/">DHL</a> <i class="fa fa-external-link"></i>
</li>
<li>
<a target="_blank" href="https://www.paxton-access.com/nl/mariaziekenhuis-overpelt-belgie/">Mariaziekenhuis Overpelt</a> <i class="fa fa-external-link"></i>
</li>
</ul>
<p>Het zou natuurlijk bijzonder ongewenst zijn als een beveiligingsprobleem zou optreden in een van deze lokaties. Het zijn
juist deze mooie referenties die mij doen besluiten om eens goed naar het

<a target="_blank" href="https://www.paxton-access.com/systems/net2/">NET2</a> <i class="fa fa-external-link"></i>
 systeem van Paxton te gaan kijken.<br>
De software die de beveiligingsbeheerder moet installeren vraagt om een certificaat te installeren.</p>
<img src="https://trideeindhoven.github.io/website/img/blog/20240830_paxton_net2_cert.png" alt="Paxton Net2 software"  >

<p>Nadere inpectie van dit scherm laat zien dat het gaat om een root-certificaat van Paxton wat in de trust-store van de
pc ge√Ønstalleerd wordt.<br>
Echter wat blijkt: Paxton heeft dit certificaat al in de truststore ge√Ønstalleerd, om de installatie zo &ldquo;eenvoudig&rdquo;
mogelijk te maken. We zitten nu in de situatie waar een third-party een root certificaat heeft ge√Ønstalleerd zonder
het de beheerder van deze (vertrouwelijke?) pc te vertellen.<br>
<img src="https://trideeindhoven.github.io/website/img/blog/20240830_paxton_net2_rootcert.png" alt="Paxton Net2 software"  >
</p>
<p>En dit certificaat is nog een kleine 20 jaar geldig. Niet ideaal&hellip;ook niet netjes&hellip;ook niet industrie standaard.</p>
<p>Ik heb eerder gepubliceerd over certificaten in het artikel over
<a href="https://trideeindhoven.github.io/website/blog/letsencrypt/">Let&rsquo;s Encrypt</a></p>
<p>Het zou veel erger zijn als dit certificaat nu gebruikt
zou kunnen worden om zelf Man In The Middle (MITM) aanvallen uit te voeren. Op deze manier zou het eenvoudig zijn om
(gevoelige) gegevens in te zien die verstuurd worden vanaf de pc van de persoon die verantwoordelijk is voor de
fysieke beveiliging van de eerder genoemde objecten.<br>
Maar: hier is een private key voor nodig. En die hoort ten alle tijden geheim te blijven. Een korte inspectie van
C:\Program Files (x86)\Paxton Access\Access Control\openssl laat de volgende twee bestanden zien:</p>
<ul>
<li>Paxton-CA.crt</li>
<li>Paxton-CA.key</li>
</ul>
<p>Het probleem begint zich nu wel een beetje af te tekenen. Het zal toch niet&hellip;?<br>
Maar: de private key in Paxton-CA.key is versleuteld en kan dus niet direct gebruikt worden om zelf certificaten
uit te geven. Maar wacht een even. Waarom kan createdevicecert.bat dat eigenlijk wel dan? Ik besluit de volgende regel
toe te voegen aan dit batch bestand:</p>
<pre><code>echo %2 &gt; private.pass  
</code></pre>
<p>Het klinkt te eenvoudig voor woorden, maar: na het opnieuw aanmaken van een certificaat voor de Net2 software heb ik
een bestand private.pass met als inhoud: &ldquo;COpKEyfArEs*****&rdquo; (gecensureerd). Het is nu inmiddels wel duidelijk dat we hier een
serieus probleem hebben en ik neem contact op met Paxton in de UK. Nog voordat ik mijn verhaal heb kunnen doen, ben ik
gegoogled en word ik naar de Nederlandse tak van Paxton verwezen. Ik leg mijn bevindingen uit aan de medewerker in
Nederland en hij geeft aan dat Paxton Nederland alleen een sales-tak is en dat ik bij Paxton UK moet zijn waar de
ontwikkelaars zitten. Ik word teruggestuurd naar Paxton UK en leg mijn bevindingen daar neer. Ik krijg van de technische
afdeling echter het teleurstellende antwoord dat het geen security probleem is, omdat het certificaat alleen in interne
netwerken gebruikt kan worden. Ik besluit te antwoorden met een eenvoudige vraag: Kunnen jullie uitleggen hoe jullie
voorkomen dat het certificaat niet gebruikt wordt voor een ip-adres buiten het interne netwerk?</p>
<p>Het antwoord laat heel even op zich wachten, waarna het kwartje in de UK ook gevallen lijkt te zijn:</p>

<blockquote class="cloudemail">
Paxton were not aware of the extent of this vulnerability, thank you for bringing this to our attention. <br/>We would very much like to discuss our plan of actions with you directly and would welcome your input/feedback on how to resolve this issue.
</blockquote>

<p>Kijk&hellip; dit had natuurlijk nooit mogen gebeuren, maar deze firma graaft zich zelf niet vast in dit gebeuren. En inderdaad:
na wat telefoontjes en overleggen wordt een concreet mitigatieplan opgesteld en krijg ik inderdaad elke paar weken een
update van de vorderingen hiervan. Door de grote userbase duurt dit proces vrij lang, maar het wordt wel heel serieus
opgepikt.</p>
<p>Als goed burger besluit ik ook het 
<a target="_blank" href="https://www.ncsc.nl/">National Cyber Security Centre (NCSC)</a> <i class="fa fa-external-link"></i>

te contacteren. Ik krijg een net mailtje terug dat het
wellicht goed is om met PGP te gaan communiceren en of ik een PGP sleutel heb. Uiteraard heb ik die en ik stuur mijn
publieke sleutel naar het NCSC op.<br>
Ik krijg een email terug dat het NCSC geen elliptic curve sleutels kan importeren en of ik een nieuwe RSA sleutel wil
maken. Aangezien mijn sleutel gepubliceerd is bedank ik vriendelijk en besluit ik om verdere communicatie dan maar
zonder PGP te gaan voeren.<br>
Het heeft wederom even wat overredingskracht nodig om de ernst van dit probleem duidelijk te maken. Om het probleem iets
duidelijker te maken maak ik een (geldig) *.rijksoverheid.nl certificaat aan wat ondertekend is met het, vertrouwde,
Paxton root certificaat.</p>
<img src="https://trideeindhoven.github.io/website/img/blog/20240830_paxton_net2_rijksoverheid.png" alt="Paxton Net2 software"  >

<p>Nu het een Rijksoverheid probleem is
gebeurt er ineens van alles. Er wordt communicatie met Paxton UK gevoerd en een CVE nummer wordt gereserveerd. Ik
beloof plechtig aan het NCSC om het wildcard certificaat voor rijksoverheid.nl niet te misbruiken of door te sturen.</p>
<p>Een tijdje later wordt het CVE gepubliceerd en zie ik dat het Amerikaanse NIST er een cvss van 9.8 (critical) aan
vast gehangen heeft:
<a href="https://nvd.nist.gov/vuln/detail/CVE-2023-43870">https://nvd.nist.gov/vuln/detail/CVE-2023-43870</a></p>
<p>Dit probleem leek zo eenvoudig: er is een geheime sleutel meegeleverd met een kritisch stuk software. Maar het blijkt
in de praktijk dan toch nog heel lastig te zijn om de betrokken partijen hiervan te overtuigen. Dit bleek in dit geval
een proces van maanden. Maar wel een proces met een hele fijne uitkomst, waar de fabrikant uiteindelijk een beter
en veiliger product heeft gemaakt. Uiteraard heb ik een aantal maanden later hun software weer onder de loupe genomen.
Ook dit keer kwam hier een interessante bevinding uit, maar daar ga ik volgende keer over schrijven. Tot dan!</p></div>
        <div class="share m-2 grid grid-cols-2 lg:grid-cols-3 gap-2">
            <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2ftrideeindhoven.github.io%2fwebsite%2fblog%2fpaxton_tls%2f&text=Paxton%20en%20het%20rebelse%20rootcertificaat" target="_blank"
                title="Tweet" class="share-button twitter">
                <div class="text-white text-center">
                    <span class="icon-twitter text-lg mr-2"></span>Twitter
                </div>
            </a>
            <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftrideeindhoven.github.io%2fwebsite%2fblog%2fpaxton_tls%2f&t=Paxton%20en%20het%20rebelse%20rootcertificaat" target="_blank"
                title="Facebook" class="share-button facebook">
                <div class="text-white text-center">
                    <span class="icon-facebook text-lg mr-2"></span>Facebook
                </div>
            </a>
            <a href="javascript:OnClickURL();" class="share-button url" title="Copy to Clipboard"
                data-clipboard-text="https://trideeindhoven.github.io/website/blog/paxton_tls/" id="url">
                <div class="text-white text-center">
                    <span class="icon-link text-lg mr-2"></span>Copy
                </div>
            </a>
        </div>
        <hr class="py-4">
        <aside id="meta">
            <div class="grid grid-cols-2">
                <div class="col-span-1">
                    
                    <a class="previous lg:text-2xl" href="https://trideeindhoven.github.io/website/blog/phera/">
                        <div
                            class="transition-colors duration-300 border border-gray-600 hover:border-black h-auto m-3 text-center py-3 lg:py-1">
                            <span class="icon-keyboard_arrow_left"></span> Aras Phera
                        </div>
                    </a>
                    
                </div>
                
                <a class="next lg:text-2xl" href="https://trideeindhoven.github.io/website/blog/paxton_licentie/">
                    <div
                        class="transition-colors duration-300 col-span-1 border border-gray-600 hover:border-black h-auto m-3 text-center py-3 lg:py-1">
                        Paxton en de luchtige licentie <span class="icon-keyboard_arrow_right"></span>
                    </div>
                </a>
                
            </div>
        </aside>
    </div>
</div>

  </main><footer class="bg-tlgray-100">
  
  <script src='/website/js/clipboard.min.js'></script>
  <script src='/website/js/highlight.min.js'></script>
  <script src='/website/js/highlightjs-line-numbers.min.js'></script>
  <script src='/website/js/sweetalert2.min.js'></script>
  <script>
    hljs.initHighlightingOnLoad();
    hljs.initLineNumbersOnLoad();
    new ClipboardJS('.url');

    function OnClickURL() {
      Swal.fire({
        icon: 'success',
        title: 'Copied!',
        text: 'Copied the URL and title.'
      })
    }
  </script>
  
  <script>
    function toggleNav() {
      var hamburger = document.getElementById("hamburgerbtn");
      var overlay = document.getElementById("overlay");
      var body = document.body;

      hamburger.addEventListener("click", function () {
        overlay.classList.toggle("open");
        hamburger.classList.toggle("is-open");
        body.classList.toggle("scroll-lock");
      });
    }
    toggleNav();

    document.querySelector('.scroll-top').addEventListener('click', () => {
      document.documentElement.scrollTop = 0;
    });
  </script>
  
  <link href='/website/css/webfonts.min.css' rel="stylesheet" />
  
  <div class="flex items-center justify-between flex-wrap bg-gray-800 p-8 text-white">
    <div class="items-center text-xl text-grey-900 mr-6">
      CloudAware Technical Consultancy
    </div>
    <div class="w-full block flex-grow lg:flex lg:items-center lg:w-auto" id="mobileMenu">
      <div class="text-lg lg:flex-grow">
      </div>
      <div class="flex flex-row items-center text-lg">
        
        <a href="/website/privacybeleid" class="block mt-4 lg:inline-block lg:mt-0 text-gray-300 hover:text-white mr-8">
          
          Privacy statement
          
        </a>
        
        <a href="/website/cookieverklaring" class="block mt-4 lg:inline-block lg:mt-0 text-gray-300 hover:text-white mr-8">
          
          Cookieverklaring
          
        </a>
        
        <a href="/website/" class="block mt-4 lg:inline-block lg:mt-0 text-gray-300 hover:text-white mr-8">
          
          Home
          
        </a>
        
        <a href="https://github.com/gitaware" class="block mt-4 lg:inline-block lg:mt-0 text-gray-300 hover:text-white mr-8">
          
          <i class='icon-github text-2xl'></i>
          
        </a>
        
      </div>
    </div>
  </div>
  <div class="copy pl-8 py-5 bg-tlgray-700 text-white text-md">
    &copy; CloudAware Technical Consultancy 2024 All Rights Reserved.
  </div>
</footer>
</body>

</html>