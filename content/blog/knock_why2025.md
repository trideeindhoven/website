+++
author = "Jeroen Hermans"
title = " WHY 2025 - Knock knock who's there 2.0, the subtle art of (physical) port knocking "
date = "2025-08-11"
description = "Presention at WHY2025 conference"
tags = [
    "why2025", "Paxton", "ARAS", "Phera", "Knock knock"
]
image = "img/yealink/pexels-donald-tong-66134.jpg"
+++
Beste lezer. Welkom bij deze serie publicaties over mijn onderzoek naar Yealink en Lydis waar ik een jaar aan gewerkt heb.
<!--more-->
In deze introductie heb ik er voor gekozen om persoonlijk toe te lichten wat er precies allemaal aan de hand is. Als 
jullie geïnteresseerd zijn in de volgende publicaties, houdt dan mijn [LinkedIn profiel](https://www.linkedin.com/in/jeroenhermans/)
in de gaten. Ik zal hier elke publicatie aankondigen. De publicaties zullen elke 2 dagen tijdens werkdagen plaatsvinden.  
Hieronder de video die ik heb gemaakt om e.e.a. persoonlijk toe te lichten. De tekst is integraal onder de video opgenomen.

## De video
{{< youtube XTRzWv6Ty3o >}}
## De tekst

So welcome to the talk knockk knockock
who's there version 20 the subplot of
physical port knocking so it's not your
ssh port you're protecting with that one
I will introduce you to yun yun who is
now in a company which is now 23 years
old and he will have the stage now.
Thank you very much. Um, thank you all
for being here today. Um, let's uh let's
start with with a quick introduction of
the agenda. Uh, I will first tell a
little bit about who I am and uh the
last knockknock talk that I did at MCH.
uh and then we will have a look at uh
three knocks that I did at the physical
uh entrance systems.
First a little bit about me. Uh I
founded my uh own company Cloudware in
2002. The first day here at Y it uh the
company was uh 23 years old. So uh
that's nice. I specialize in cyber
security and I do some public speaking.
The company is based in in the hake and
here at Y 2025 you can find me at the
the Swiss village which which does not
have a tax reason.
Just wanted to put that out there. Um so
let's look a little bit back to
knockknock 1.0. Uh I had a look at the
uh building entrance systems of
Komaalit. Um that was a unencrypted
system. Uh it was unauthenticated.
Uh it was unauthorized. Uh it was
unvalidated.
Um and it was broadcasted on a bus. So
in short, you can see who's at your
neighbor's door. you can open the door
for a random apartment number uh and
much much more.
So the talk is still on YouTube. So if
you want to see it then please do
right. Um
so yeah I think that sums it up.
After knockknock 1.0 Z um people started
talking to me as uh as it often goes in
cyber security and they said maybe you
should have a look at this system and so
I did
so let's have a look at the first knock
and the first knock is a company called
and uh says themselves they provide uh
solutions that meet the highest
standards
set by organizations such as the
ministry of defense and has proven
expertise in securing large university
campuses, museums, uh data centers,
distribution centers, industrial
complexes and retail change chains. So
this is a system that should be
extremely secure. Fantastic. So let's
have a look at it.
And the system that I had a look at is
called Vyra. Um
and Fra has a PDF document that
describes uh what this uh system is. And
it basically starts with this Dutch
sentence that you can see here which
translates into Farah um accessible in
every possible way. And
I believe that um
uh the document also contains the world
word secure 27 times. So um this must be
a very high secure system.
But are we sure? So I had a look at it
and um a little bit further in the
document it says uh this Dutch text
which says 100% secure
which is an extremely academic way of
describing the system.
So
moving on it says um it has a highest
level of security by using encryption.
Oh wow. So, um, does it mention anywhere
else that it is this safe? Uh, and it
says there's secure communication
between all devices.
Now, this is fantastic. I like a company
that takes security into account at when
developing systems. So, does it also
mention how it does this? And luckily,
it does. It says it uses technologies
such as HTTPS,
ghost, single, and AIS.
Wait, I think we have to go back a
little bit because as far as I know, and
I looked it up, uh, GOS is broken in
2008 and single desk, I think that the
the first time that it was mentioned
that it would theoretically be broken
was in 1995.
Um okay. So um maybe there are other
ways to secure this system. Um
but maybe doesn't agree with that
because uh they pro are probably not too
proud of this because at the moment the
website looks like this. Um so they had
to take it down for a reason that they
did did not disclose.
So this is a system that uses access
cards. Um so I thought let's have a look
at how these access cards work and it
says it uses two crypt. I was not aware
what two crypt is. I'm don't know does
anyone here know maybe hands? No. I saw
half a hand. So
neither did I. I didn't know what two
crypt was. So, I looked it up and it
said,
"Two prep cards and readers are equipped
with dual encryption." Ooh. First, the
standard encryption of a Myare card is
applied. Oh. Using its associated
security key. Yeah, we don't know that
one. Then, the card number is
additionally encrypted and stored on the
card uh linked to its card's serial
number. Even if the entire contents of
the cards are copied to another card, it
will no longer match the original serial
number and will therefore be rejected by
the card readon. Now I think objectively
I would not call this 100% sure.
Um because indeed um if you buy a myfare
card here in Holland uh sector zero is
not writable. So I cannot write the
serial number. But if I go to
AliExpress, I buy the much cheaper
Myfare cards and they don't have that
protection. So I can write this sector
zero.
So obviously the next step that you do
as a researcher you contact Iris about
this and I said uh listen uh I found
this and I have some questions and um I
got a very quick response from the uh
product manager entrance systems
and it says the fact that you can
retrieve that key is nothing new. I've
done it myself once and if I can do it
there are definitely others who can do
it as well.
Now, this is the same company that like
two minutes ago said it's 100% safe. Um
um it's an interesting um conclusion.
So, um
I think then it's time to go to the
second knock.
And for the second doc again, there was
a guy that said to me, "Hey, maybe you
should have a look at this company. And
who am I not to comply?"
So I had a look at the company Paxton.
Um I don't know if anyone knows Paxton.
Yeah.
So half a person knows who is Paxton. So
I neither did I. I didn't know. Um, and
it says, "Pexin is a company with 30
years of experience design marketing
leading security solutions for a range
of buildings. 30,000 buildings each year
are secured globally with Paxton
products. Um, 30,000 buildings. I didn't
know any of them. So, surely I should be
able to Google who is using this." So, I
looked it up and it's it's an
interesting list. Um, so I found um, uh,
soccer stadiums, Manchester United is
using it. So that's interesting. Uh,
airports were are using it. Um, fire
brigades are using it. This is the an
actual picture of the Paxton security
office. Um,
hospitals are using it. Uh, multiple TV
studios are using it.
Uh boat pilots are using it to secure
harbors. Um a jail in the US is using
it. That's convenient. Um ISPs are using
it and uh a marijuana wana facility.
So this is an interesting set of
companies who are using this product.
Um, so if this product would for any
reason not be secure, you could actually
go into a hospital, um, steal drugs from
their pharmacy, then get past security
in the stadium, watch the game, then go
to your ISP, assign yourself unlimited
bandwidth, um, steal a,000 pounds of
cannabis, go home, uh, ste break into
the TV studio, schedule your favorite
movie at prime time, go at home, watch
the movie with your hospital supplies
and £1,000 and then flee the country by
plane or boat for that matter. And if
you do get caught, you can get out of
jail.
There's a top tip,
[Applause]
but um they also have an API and
everyone here thinks that's extra
interesting and I fully agree. Um but so
I asked Paxton, can you give me access
uh to this API
just for reference? This is an API that
is running on my own machine. Um and
they denied it. They said you cannot get
this license file uh because we don't
think that you have enough knowledge to
use the API on your own machine. Okay.
Um
it has a free SDK luckily um online and
um um and in that SDK is a um a a
license file. So I reverse engineered
that a little bit
and it turned out not to be too
difficult to generate a license file. So
I was able to use that API. Fantastic.
But um this is a authentication problem.
So I went to the Dutch CNA for getting a
CVE assigned. Um they needed a little
bit of persuation. Um
I informed them and they needed a little
bit of persuation and
I did it this way. Uh I made a license
file
and let me go over this license file.
I'm not sure if you can all read it but
uh please do watch the recording later
on and I will go over this uh myself
now. Um so the first the license ID is
uh as you can see 42 42 42 42 uh as long
as this is a random UYU ID it's valid.
It accepts it. Fantastic. We can do
that.
The expiration date has to be valid. So
this expiration date is Sunday June 23,
3022.
That is an actual date. If you change
anything in that date, it will not
accept it. So if you make from the
Sunday a Monday, it will not accept it.
So it has a calendar function in the
validation.
Um the client ID there, that's just any
random UYU ID. So if you generate a UYU
ID and just put it in there, it will
accept it.
Um maybe some of you maybe the Dutch
people uh have already seen that the
lency is Marut which at the time of this
was uh the prime minister of Holland and
at the moment is the secretary general
of NATO the organization that is going
to save us all and
and I think everyone is already looking
at that signature and trying to figure
out what is that signature because
obviously that's a B 64 um signature.
There it is.
I generated the signature, but I wanted
to make sure that this signal signature
was actually ignored by the software.
So, the signature is actually B 64 for
there's no way this is this easy.
So,
um that means we can use the API and the
license file is accepted. Fantastic. So,
but what does this API actually do? So,
um oh wait, but before um this was the
persuation file for the Dutch CNA uh
National Cyber Security Center and
because it was the Dutch Prime Minister,
they did think it was important and the
CVE was assigned.
[Applause]
Thank you. Um let's have a look at what
the API does. So that's the third knock.
Um the Pexon Netu API um um uh can
create, read, delete user information,
time sheets, so who worked when um uh
presence reports uh which will be
important later on. So who was where
when um and it can post commands to all
the nodes in the Paxton network. So that
presumably are locks to update firmware
and stuff like that. Um so if we don't
want to end up with a,000 pounds of
cannabis on our couch, the security of
this needs to be of the highest level.
How did they uh secure this? Um, they
did not use a self-signed certificate
for this. Remind this is just running on
your local machine and your local
machine is the person managing the
security in the facilities that we just
went over. So, it's important. It's an
important PC. Um, they actually used PKI
infrastructure. Um, so I think most
people know what a PKI is, but it's um
it's like a notary. Uh, it's like a
digital no. Let's see how can I can
explain what goes wrong. Yeah, I think
that that explains everything.
And actually that is exactly what went
wrong. Um,
maybe the best known CA is let's
encrypt. I think everyone knows this
one. And it has this levels of uh
certificates. So one certificate is
signing the other one and the top
certificate needs to be trusted by your
browser. If that is not trusted, any
other certificates that are signed will
also not be accepted.
So how did Pexon do this? Well, during
the installation of the Netu pack
software, it asks to install a CA
certificate. That certificate is
normally not in your computer's trust
store. Um, unfortunately,
it does ask me to do this, but it was
already installed.
Um, so the netu software secretly
installed a uh certificate in my trust
store uh that um I can use to sign uh
other certificates for. And now remember
this is a computer in a physical
security position in hospitals, soccer
stadiums, you name it, marijuana
facilities.
So the next thing that I asked myself is
so where is this certificate coming
from? Where is the local certificate
coming from? So not the the certificate
authority certificate, the local
certificate.
So I went uh into the directories and I
saw Paxton access open SSL and there
were two files there. Pexton CARTT and
Pexton CA key
and I was a little bit too early
celebrating because that one is
encrypted. Ah I can't read it. So that
was unfortunate. So then I had to use
all my encryption skills to recover this
secret password because there was a
third file and that was create device
certificate.b8.
Yeah. And um so I used all my knowledge
that I had and I added a single line to
this file
and um after
30 seconds I had the
uh the password for the CA key. Um this
is the actual uh key and I had to blur a
little bit away because I don't want to
you know leak passwords to everyone here
especially not you people. especially
not. Um
again I contacted the national cyber
security center uh and they requested
again that uh is this important is it
relevant etc etc but this time I learned
so I um I created an actual certificate
for asterisk.go.nl.
Uh that raised some questions and also
relevance. Um, so CVC CVE was assigned
and this time it was a 9.8 critical
and
but I hear everyone thinking you didn't
look at the application itself. Now
that's a very good point. So we have a
bonus knock.
Um the application itself is uh is a is
a is a database. Uh may maybe let's
settle this now because you people know
this. Um is it MSSQL or is it MSSQL?
This is we think it's MSSQL
and my MSSQL.
I'm going with MSSQL but it's 50/50. Um
So um so there's a there's a SQL
database there. Uh it has an enginex uh
web server uh for running the
formentioned uh REST API.
Um and it has a Windows application that
uses the rest API to communicate with uh
the database.
Um we already looked at that REST API.
We know what it can do. Um uh the
Windows application that is work for the
future. Um so all the statement stateful
information must be in this SQL
database. So that is the next thing that
I had a look at. Now in this database uh
there must be a lot of personal
identifying information in there. PIN
codes of course for opening locks that's
unencrypted. Um the card numbers
themselves which is very convenient if
you want to clone card numbers. Um,
and then the usual uh personal
information like names, email addresses,
phone numbers, you name it.
Um,
I want to get a access to this database.
And it's actually very simple because
Microsoft SQL Server has a single user
mode. So you just stop the service,
start the service in single user mode,
add a new admin user, stop the service
in single user mode, start the service
again, and now I'm admin.
Now, now it's all fun and games, but
there's also a serious side to this to
this uh story because
uh yeah, I Oh, yeah. And of course, I
automated this in a Python script, so
you actually don't see it happening in a
uh in a live environment.
I'm in.
But there's a serious undertone here
because forensics. Um, I asked a former
detective, which is not in this picture,
uh, and I asked him, "So, but what if in
one of these facilities someone breaks
in, um, with a cloned card, right? Um,
uh,
how does the police treat this forensic
data?" Because obviously Paxton is
saying it is forensic data and they will
communicate with the police in order to
hand over this data. Um and he said well
we we don't have any reason to doubt
this information. So if you work in that
hospital and then supplies from the
hospital get stolen uh and someone used
your credentials uh from this uh
Microsoft database um you may be in
legal trouble and I think that is
something that organizations like the
police need to know um that potentially
the forensic data is not to be trusted.
Uh luckily the National Cyber Security
Center agreed with me so they assigned
another CV.
[Applause]
So in the end um
we um got added to Paxton wall of fame.
Wall of shame I almost said. Well
um the vulnerabilities were fixed. Um I
will come back to them. Let's see if
that's done properly because due
diligence and um and we were sent
hoodies which is nice
but that went wrong because they send us
didn't send us hoodies they sent us
company clothing.
[Applause]
So now we have deep knowledge about
their systems and we have uh we look
like employees. So what could possibly
go wrong?
I think that's a that will be a good
talk in the next uh next time.
Yeah, disclosures disclosures they are
important. You see a lot of CVs were
assigned uh and sometimes it does take a
little bit of effort. Um but uh I think
disclosures are very manufacturer
focused. I just walked past uh uh the
the a-hole and there was a talk from uh
DID fantastic people do fantastic work
and it says you know it's important to
disclose to the manufacturer um I do
think it's important to disclose to the
manufacturer because they are the
persons who need to fix this but I also
think the victims
or sometimes also called customers also
need to be involved in this process
because what now happens you get a full
disclosure after the manufacturer fixed
something and then the IT teams at the
victims they need to work very very fast
to fix everything and then things go
wrong. Um tomorrow I also have a talk
about uh uh the telecommunication
company Yearink. Uh I will go more into
detail about uh uh how I do um
disclosures and how tricky that can be
and also legally.
So disclosures they are complicated
legally because um you know I do not
want to be able to I do not want to have
to use to break out of jail. Um but also
politically
I already gave you a few examples where
I had to convince the CNA that this is
something important. Um it should not be
like that. assign a low CVSs that's fine
but the CVE is still there. So uh I
think there's some work that needs to be
done too. Um so yeah um that is uh what
I uh uh knocked on a few doors in uh in
the past uh two years. Um and I think we
have ample time for some questions.
So, who has a question?
There are none. That is
That is a That's new.
That That's a good sign.
Thank you.
So, thank you, Kon.
Ah.
